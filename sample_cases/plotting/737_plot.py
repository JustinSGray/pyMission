from __future__ import division

import os.path

import numpy as np
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import matplotlib.colors as colors
import matplotlib.cm as cmx

from openmdao.lib.casehandlers.api import CaseDataset

NCURVES = 1
num_lines = range(NCURVES)
folder_path = '737_data'
dists = []
alts = []
machs = []
speeds = []
alphas = []
fuels = []
thrusts = []
weights = []
throttles = []
etas = []
rhos = []
lift_cs = []
drag_cs = []
gammas = []
temps = []

num_plts = 23


name = 'mission_history_737.bson'

cds = CaseDataset(os.path.join(folder_path, name), 'bson')

ac_w = cds.simulation_info['constants']['ac_w']
S = cds.simulation_info['constants']['S']
# print [n for n in cds.simulation_info['constants'].keys() if 'alpha' in n]
# print cds.simulation_info['constants']['coupled_solver.alpha']
# exit() # ['SysAeroSurrogate.alpha']

data = cds.data.driver('driver').by_variable().fetch()

dist = np.array(data['SysXBspline.x'][-1]) * 1e6
altitude = np.array(data['SysHBspline.h'][-1]) * 1e3
rho = np.array(data['SysRho.rho'][-1]) * 1e2

temp = np.array(data['SysTemp.temp'][-1]) * 1e2
speed = np.array(data['SysSpeed.v'][-1]) * 1e2

#alpha = np.array(data['SysCTTar.alpha'][-1]) * 1e-1 * 180/np.pi

alpha = np.array([ 0.04910292,  0.07383016,  0.11480911,  0.16899915,  0.23284648,
        0.30121282,  0.3668361 ,  0.42092049,  0.45570305,  0.46921554,
        0.47000067,  0.46949661,  0.46899281,  0.46848926,  0.46798596,
        0.46748291,  0.46698012,  0.46647758,  0.46597529,  0.46547325,
        0.46497147,  0.46446994,  0.46396865,  0.46346762,  0.46296684,
        0.46246631,  0.46196603,  0.46146599,  0.46096621,  0.46046668,
        0.45996739,  0.45946836,  0.45896957,  0.45847103,  0.45797274,
        0.4574747 ,  0.45697691,  0.45647936,  0.45598206,  0.455485  ,
        0.45498819,  0.45449163,  0.45399532,  0.45349925,  0.45300342,
        0.45250784,  0.45201251,  0.45151742,  0.45102258,  0.45052798,
        0.45003362,  0.44953951,  0.44904564,  0.44855201,  0.44805863,
        0.44756549,  0.44707259,  0.44657994,  0.44608753,  0.44559536,
        0.44510343,  0.44461174,  0.44412029,  0.44362909,  0.44313812,
        0.4426474 ,  0.44215691,  0.44166667,  0.44117667,  0.4406869 ,
        0.44019737,  0.43970809,  0.43921904,  0.43873023,  0.43824166,
        0.43775332,  0.43726523,  0.43677737,  0.43628975,  0.43580237,
        0.43531522,  0.43482831,  0.43434164,  0.4338552 ,  0.433369  ,
        0.43288303,  0.4323973 ,  0.43191181,  0.43142655,  0.43094152,
        0.43045673,  0.42997217,  0.42948785,  0.42900376,  0.42851991,
        0.42803628,  0.4275529 ,  0.42706974,  0.42658682,  0.42610413,
        0.42562167,  0.42513944,  0.42465745,  0.42417568,  0.42369415,
        0.42321285,  0.42273178,  0.42225094,  0.42177033,  0.42128996,
        0.42080981,  0.42032989,  0.4198502 ,  0.41937074,  0.41889151,
        0.4184125 ,  0.41793373,  0.41745519,  0.41697687,  0.41649878,
        0.41602092,  0.41554328,  0.41506588,  0.4145887 ,  0.41411174,
        0.41363502,  0.41315851,  0.41268224,  0.41220619,  0.41173037,
        0.41125477,  0.4107794 ,  0.41030425,  0.40982933,  0.40935463,
        0.40888016,  0.40840591,  0.40793189,  0.40745808,  0.40698451,
        0.40651115,  0.40603802,  0.40556511,  0.40509242,  0.40461996,
        0.40414772,  0.4036757 ,  0.4032039 ,  0.40273232,  0.40226097,
        0.40178984,  0.40131892,  0.40084823,  0.40037776,  0.3999075 ,
        0.39943747,  0.39896766,  0.39849807,  0.39802869,  0.39755954,
        0.39709061,  0.39662189,  0.39615339,  0.39568511,  0.39521705,
        0.39474921,  0.39428158,  0.39381417,  0.39334698,  0.39288001,
        0.39241325,  0.39194671,  0.39148038,  0.39101427,  0.39054838,
        0.3900827 ,  0.38961724,  0.389152  ,  0.38868697,  0.38822215,
        0.38775755,  0.38729316,  0.38682899,  0.38636503,  0.38590129,
        0.38543776,  0.38497444,  0.38451134,  0.38404845,  0.38358577,
        0.3831233 ,  0.38266105,  0.38219901,  0.38173718,  0.38127556,
        0.38081416,  0.38035296,  0.37989198,  0.37943121,  0.37897065,
        0.3785103 ,  0.37805016,  0.37759023,  0.37713051,  0.376671  ,
        0.3762117 ,  0.37575261,  0.37529373,  0.37483505,  0.37437659,
        0.37391833,  0.37346029,  0.37300245,  0.37254481,  0.37208739,
        0.37163018,  0.37117317,  0.37071637,  0.37025977,  0.36980338,
        0.3693472 ,  0.36889123,  0.36843546,  0.3679799 ,  0.36752454,
        0.36706939,  0.36661444,  0.3661597 ,  0.36570517,  0.36525084,
        0.36479671,  0.36434279,  0.36388907,  0.36343556,  0.36298225,
        0.36252914,  0.36207624,  0.36162354,  0.36117104,  0.36071875,
        0.36026666,  0.35981477,  0.35936308,  0.3589116 ,  0.35846031,
        0.35800923,  0.35755835,  0.35710767,  0.3566572 ,  0.35620692,
        0.35575684,  0.35530697,  0.35485729,  0.35440782,  0.35395854,
        0.35350947,  0.35306059,  0.35261192,  0.35216344,  0.35171516,
        0.35126708,  0.3508192 ,  0.35037152,  0.34992404,  0.34947675,
        0.34902966,  0.34858277,  0.34813608,  0.34768958,  0.34724328,
        0.34679718,  0.34635128,  0.34590557,  0.34546005,  0.34501474,
        0.34456962,  0.34412469,  0.34367996,  0.34323543,  0.34279109,
        0.34234695,  0.341903  ,  0.34145925,  0.34101569,  0.34057232,
        0.34012915,  0.33968617,  0.33924339,  0.3388008 ,  0.3383584 ,
        0.3379162 ,  0.33747419,  0.33703237,  0.33659075,  0.33614932,
        0.33570808,  0.33526703,  0.33482617,  0.33438551,  0.33394503,
        0.33350475,  0.33306466,  0.33262476,  0.33218505,  0.33174554,
        0.33130621,  0.33086707,  0.33042812,  0.32998937,  0.3295508 ,
        0.32911242,  0.32867423,  0.32823623,  0.32779842,  0.3273608 ,
        0.32692337,  0.32648612,  0.32604907,  0.3256122 ,  0.32517552,
        0.32473902,  0.32430272,  0.3238666 ,  0.32343067,  0.32299493,
        0.32255937,  0.322124  ,  0.32168882,  0.32125382,  0.32081901,
        0.32038439,  0.31994995,  0.3195157 ,  0.31908163,  0.31864775,
        0.31821405,  0.31778054,  0.31734721,  0.31691407,  0.31648111,
        0.31604833,  0.31561574,  0.31518334,  0.31475111,  0.31431907,
        0.31388722,  0.31345555,  0.31302406,  0.31259275,  0.31216163,
        0.31173068,  0.31129993,  0.31086935,  0.31043895,  0.31000874,
        0.30957871,  0.30914886,  0.30871919,  0.3082897 ,  0.3078604 ,
        0.30743127,  0.30700233,  0.30657356,  0.30614498,  0.30571657,
        0.30528835,  0.30486031,  0.30443244,  0.30400476,  0.30357725,
        0.30314992,  0.30272278,  0.30229581,  0.30186902,  0.3014424 ,
        0.30101597,  0.30058971,  0.30016364,  0.29973774,  0.29931202,
        0.29888647,  0.2984611 ,  0.29803591,  0.2976109 ,  0.29718606,
        0.2967614 ,  0.29633692,  0.29591261,  0.29548848,  0.29506453,
        0.29464075,  0.29421714,  0.29379372,  0.29337046,  0.29294739,
        0.29252448,  0.29210175,  0.2916792 ,  0.29125682,  0.29083462,
        0.29041259,  0.28999073,  0.28956905,  0.28914754,  0.28872621,
        0.28830504,  0.28788406,  0.28746324,  0.2870426 ,  0.28662213,
        0.28620183,  0.2857817 ,  0.28536175,  0.28494197,  0.28452236,
        0.28410293,  0.28368366,  0.28326457,  0.28284564,  0.28242689,
        0.28200831,  0.2815899 ,  0.28117166,  0.28075359,  0.28033569,
        0.27991797,  0.27950041,  0.27908302,  0.2786658 ,  0.27824875,
        0.27783187,  0.27741516,  0.27699862,  0.27658225,  0.27616604,
        0.27575001,  0.27533414,  0.27491844,  0.27450291,  0.27408755,
        0.27367235,  0.27325733,  0.27284247,  0.27242778,  0.27201325,
        0.27159889,  0.2711847 ,  0.27077068,  0.27035682,  0.26994313,
        0.2695296 ,  0.26911624,  0.26870305,  0.26829002,  0.26787716,
        0.26746447,  0.26705194,  0.26663957,  0.26622737,  0.26581533,
        0.26540346,  0.26499176,  0.26458022,  0.26416884,  0.26375762,
        0.26334658,  0.26293569,  0.26252497,  0.26211441,  0.26170401,
        0.26129378,  0.26088371,  0.26047381,  0.26006406,  0.25965448,
        0.2592427 ,  0.25840709,  0.2558544 ,  0.25022032,  0.24025828,
        0.22495745,  0.20440079,  0.18047298,  0.15507683,  0.12978441,
        0.1057989 ,  0.08374381,  0.0635483 ,  0.04507661,  0.02820862,
        0.01283836, -0.00112726, -0.01376959, -0.02515908, -0.03535605,
       -0.04441127, -0.05236638, -0.0592542 , -0.06509884, -0.06991574,
       -0.07371146]) * 1e-1 * 180/np.pi
throttle = np.array(data['SysTau.tau'][-1])
#eta = np.array(data['SysAeroSurrogate.eta'][-1]) * 1e-1 * 180/np.pi
eta = np.array([-0.02918381, -0.04388019, -0.06823561, -0.10044289, -0.13838989,
       -0.17902271, -0.21802523, -0.25016972, -0.27084238, -0.27887339,
       -0.27934002, -0.27904044, -0.27874101, -0.27844173, -0.2781426 ,
       -0.27784362, -0.27754479, -0.27724611, -0.27694758, -0.2766492 ,
       -0.27635097, -0.27605289, -0.27575495, -0.27545717, -0.27515954,
       -0.27486205, -0.27456471, -0.27426752, -0.27397048, -0.27367359,
       -0.27337685, -0.27308025, -0.2727838 , -0.2724875 , -0.27219135,
       -0.27189534, -0.27159948, -0.27130377, -0.2710082 , -0.27071278,
       -0.27041751, -0.27012239, -0.26982741, -0.26953257, -0.26923788,
       -0.26894334, -0.26864895, -0.26835469, -0.26806059, -0.26776663,
       -0.26747281, -0.26717914, -0.26688562, -0.26659223, -0.266299  ,
       -0.26600591, -0.26571296, -0.26542015, -0.26512749, -0.26483498,
       -0.2645426 , -0.26425037, -0.26395829, -0.26366634, -0.26337455,
       -0.26308289, -0.26279137, -0.2625    , -0.26220877, -0.26191769,
       -0.26162674, -0.26133594, -0.26104528, -0.26075476, -0.26046438,
       -0.26017415, -0.25988405, -0.2595941 , -0.25930429, -0.25901461,
       -0.25872508, -0.25843569, -0.25814644, -0.25785734, -0.25756837,
       -0.25727954, -0.25699085, -0.2567023 , -0.25641389, -0.25612562,
       -0.25583749, -0.2555495 , -0.25526165, -0.25497393, -0.25468636,
       -0.25439892, -0.25411163, -0.25382447, -0.25353745, -0.25325057,
       -0.25296382, -0.25267722, -0.25239075, -0.25210442, -0.25181822,
       -0.25153217, -0.25124625, -0.25096047, -0.25067482, -0.25038931,
       -0.25010394, -0.24981871, -0.24953361, -0.24924865, -0.24896382,
       -0.24867913, -0.24839458, -0.24811016, -0.24782587, -0.24754173,
       -0.24725771, -0.24697384, -0.2466901 , -0.24640649, -0.24612302,
       -0.24583968, -0.24555648, -0.24527341, -0.24499047, -0.24470767,
       -0.24442501, -0.24414247, -0.24386008, -0.24357781, -0.24329568,
       -0.24301368, -0.24273182, -0.24245008, -0.24216848, -0.24188702,
       -0.24160568, -0.24132448, -0.24104342, -0.24076248, -0.24048168,
       -0.240201  , -0.23992046, -0.23964005, -0.23935978, -0.23907963,
       -0.23879962, -0.23851974, -0.23823999, -0.23796037, -0.23768088,
       -0.23740152, -0.23712229, -0.23684319, -0.23656422, -0.23628539,
       -0.23600668, -0.2357281 , -0.23544966, -0.23517134, -0.23489315,
       -0.23461509, -0.23433717, -0.23405937, -0.2337817 , -0.23350415,
       -0.23322674, -0.23294946, -0.2326723 , -0.23239528, -0.23211838,
       -0.23184161, -0.23156497, -0.23128845, -0.23101207, -0.23073581,
       -0.23045968, -0.23018367, -0.2299078 , -0.22963205, -0.22935643,
       -0.22908093, -0.22880556, -0.22853032, -0.22825521, -0.22798022,
       -0.22770536, -0.22743062, -0.22715601, -0.22688153, -0.22660717,
       -0.22633294, -0.22605884, -0.22578486, -0.225511  , -0.22523727,
       -0.22496367, -0.22469019, -0.22441683, -0.2241436 , -0.2238705 ,
       -0.22359752, -0.22332466, -0.22305193, -0.22277932, -0.22250684,
       -0.22223448, -0.22196224, -0.22169013, -0.22141814, -0.22114628,
       -0.22087454, -0.22060292, -0.22033143, -0.22006005, -0.2197888 ,
       -0.21951768, -0.21924667, -0.21897579, -0.21870503, -0.2184344 ,
       -0.21816388, -0.21789349, -0.21762322, -0.21735307, -0.21708304,
       -0.21681314, -0.21654336, -0.21627369, -0.21600415, -0.21573473,
       -0.21546543, -0.21519625, -0.2149272 , -0.21465826, -0.21438944,
       -0.21412075, -0.21385217, -0.21358372, -0.21331538, -0.21304717,
       -0.21277907, -0.2125111 , -0.21224324, -0.2119755 , -0.21170789,
       -0.21144039, -0.21117301, -0.21090575, -0.21063861, -0.21037159,
       -0.21010468, -0.2098379 , -0.20957123, -0.20930469, -0.20903826,
       -0.20877195, -0.20850575, -0.20823968, -0.20797372, -0.20770788,
       -0.20744216, -0.20717655, -0.20691106, -0.20664569, -0.20638044,
       -0.20611531, -0.20585029, -0.20558538, -0.2053206 , -0.20505593,
       -0.20479138, -0.20452694, -0.20426262, -0.20399842, -0.20373433,
       -0.20347036, -0.2032065 , -0.20294276, -0.20267913, -0.20241563,
       -0.20215223, -0.20188895, -0.20162579, -0.20136274, -0.20109981,
       -0.20083699, -0.20057428, -0.20031169, -0.20004922, -0.19978686,
       -0.19952461, -0.19926248, -0.19900046, -0.19873856, -0.19847677,
       -0.19821509, -0.19795353, -0.19769208, -0.19743074, -0.19716952,
       -0.19690841, -0.19664741, -0.19638653, -0.19612576, -0.1958651 ,
       -0.19560455, -0.19534412, -0.1950838 , -0.19482359, -0.19456349,
       -0.19430351, -0.19404364, -0.19378388, -0.19352423, -0.19326469,
       -0.19300527, -0.19274596, -0.19248675, -0.19222766, -0.19196868,
       -0.19170982, -0.19145106, -0.19119241, -0.19093388, -0.19067545,
       -0.19041714, -0.19015893, -0.18990084, -0.18964285, -0.18938498,
       -0.18912722, -0.18886956, -0.18861202, -0.18835459, -0.18809726,
       -0.18784005, -0.18758294, -0.18732594, -0.18706906, -0.18681228,
       -0.18655561, -0.18629905, -0.1860426 , -0.18578626, -0.18553002,
       -0.1852739 , -0.18501788, -0.18476197, -0.18450617, -0.18425048,
       -0.18399489, -0.18373942, -0.18348405, -0.18322879, -0.18297363,
       -0.18271859, -0.18246365, -0.18220882, -0.18195409, -0.18169947,
       -0.18144496, -0.18119056, -0.18093626, -0.18068207, -0.18042799,
       -0.18017401, -0.17992014, -0.17966638, -0.17941272, -0.17915916,
       -0.17890572, -0.17865238, -0.17839914, -0.17814601, -0.17789299,
       -0.17764007, -0.17738726, -0.17713455, -0.17688195, -0.17662945,
       -0.17637706, -0.17612477, -0.17587259, -0.17562051, -0.17536854,
       -0.17511667, -0.17486491, -0.17461325, -0.17436169, -0.17411024,
       -0.17385889, -0.17360765, -0.17335651, -0.17310547, -0.17285454,
       -0.17260371, -0.17235298, -0.17210236, -0.17185184, -0.17160142,
       -0.17135111, -0.1711009 , -0.17085079, -0.17060079, -0.17035089,
       -0.17010109, -0.16985139, -0.1696018 , -0.1693523 , -0.16910291,
       -0.16885363, -0.16860444, -0.16835536, -0.16810637, -0.16785749,
       -0.16760871, -0.16736004, -0.16711146, -0.16686298, -0.16661461,
       -0.16636634, -0.16611817, -0.1658701 , -0.16562213, -0.16537426,
       -0.16512649, -0.16487882, -0.16463126, -0.16438379, -0.16413642,
       -0.16388916, -0.16364199, -0.16339492, -0.16314796, -0.16290109,
       -0.16265432, -0.16240766, -0.16216109, -0.16191462, -0.16166825,
       -0.16142198, -0.16117581, -0.16092974, -0.16068377, -0.1604379 ,
       -0.16019212, -0.15994645, -0.15970087, -0.15945539, -0.15921001,
       -0.15896473, -0.15871955, -0.15847446, -0.15822947, -0.15798459,
       -0.15773979, -0.1574951 , -0.15725051, -0.15700601, -0.15676161,
       -0.1565173 , -0.1562731 , -0.15602899, -0.15578498, -0.15554107,
       -0.15529725, -0.15505353, -0.1548099 , -0.15456638, -0.15432295,
       -0.15407821, -0.15358157, -0.15206441, -0.14871585, -0.14279502,
       -0.13370113, -0.12148349, -0.10726224, -0.09216831, -0.07713602,
       -0.06288048, -0.04977226, -0.03776927, -0.02679081, -0.0167655 ,
       -0.00763035,  0.00066998,  0.00818381,  0.01495304,  0.0210135 ,
        0.02639538,  0.03112342,  0.03521712,  0.03869082,  0.04155369,
        0.04380964]) * 1e-1 * 180/np.pi
fuel = np.array(data['SysFuelWeight.fuel_w'][-1]) * 1e5

thrust = np.array(data['SysCTTar.CT_tar'][-1])*0.5*rho*speed**2*S*1e2 * 1e-1
weight = ac_w*1e6 + fuel*1e5

lift_c = np.array(data['SysCLTar.CL'][-1])
#drag_c = np.array(data['SysAeroSurrogate.CD'][-1]) * 1e-1
drag_c = np.array([ 0.19813254,  0.20245463,  0.21002647,  0.22082295,  0.23468853,
        0.25090886,  0.26781433,  0.28273092,  0.29279366,  0.29680203,
        0.29703664,  0.296886  ,  0.29673551,  0.29658518,  0.29643499,
        0.29628496,  0.29613509,  0.29598536,  0.29583578,  0.29568636,
        0.29553709,  0.29538797,  0.295239  ,  0.29509018,  0.29494151,
        0.29479299,  0.29464463,  0.29449641,  0.29434834,  0.29420042,
        0.29405265,  0.29390503,  0.29375756,  0.29361024,  0.29346307,
        0.29331605,  0.29316917,  0.29302245,  0.29287587,  0.29272943,
        0.29258315,  0.29243701,  0.29229103,  0.29214518,  0.29199949,
        0.29185394,  0.29170854,  0.29156328,  0.29141817,  0.29127321,
        0.29112839,  0.29098372,  0.2908392 ,  0.29069481,  0.29055058,
        0.29040649,  0.29026254,  0.29011874,  0.28997508,  0.28983157,
        0.2896882 ,  0.28954497,  0.28940189,  0.28925895,  0.28911616,
        0.28897351,  0.288831  ,  0.28868863,  0.28854641,  0.28840433,
        0.28826239,  0.28812059,  0.28797894,  0.28783742,  0.28769605,
        0.28755482,  0.28741373,  0.28727279,  0.28713198,  0.28699131,
        0.28685079,  0.2867104 ,  0.28657015,  0.28643005,  0.28629008,
        0.28615026,  0.28601057,  0.28587102,  0.28573161,  0.28559234,
        0.28545321,  0.28531422,  0.28517537,  0.28503665,  0.28489808,
        0.28475964,  0.28462134,  0.28448317,  0.28434515,  0.28420726,
        0.2840695 ,  0.28393189,  0.28379441,  0.28365707,  0.28351986,
        0.28338279,  0.28324586,  0.28310906,  0.2829724 ,  0.28283588,
        0.28269948,  0.28256323,  0.28242711,  0.28229112,  0.28215527,
        0.28201956,  0.28188398,  0.28174853,  0.28161322,  0.28147804,
        0.28134299,  0.28120808,  0.2810733 ,  0.28093866,  0.28080415,
        0.28066977,  0.28053552,  0.28040141,  0.28026743,  0.28013358,
        0.27999986,  0.27986628,  0.27973283,  0.2795995 ,  0.27946632,
        0.27933326,  0.27920033,  0.27906753,  0.27893487,  0.27880234,
        0.27866993,  0.27853766,  0.27840552,  0.2782735 ,  0.27814162,
        0.27800987,  0.27787825,  0.27774675,  0.27761539,  0.27748415,
        0.27735305,  0.27722207,  0.27709122,  0.2769605 ,  0.27682991,
        0.27669945,  0.27656911,  0.2764389 ,  0.27630882,  0.27617887,
        0.27604905,  0.27591935,  0.27578978,  0.27566034,  0.27553102,
        0.27540183,  0.27527277,  0.27514383,  0.27501502,  0.27488634,
        0.27475778,  0.27462935,  0.27450104,  0.27437286,  0.2742448 ,
        0.27411687,  0.27398907,  0.27386139,  0.27373383,  0.2736064 ,
        0.2734791 ,  0.27335191,  0.27322485,  0.27309792,  0.27297111,
        0.27284442,  0.27271786,  0.27259142,  0.27246511,  0.27233891,
        0.27221284,  0.2720869 ,  0.27196107,  0.27183537,  0.27170979,
        0.27158433,  0.271459  ,  0.27133378,  0.27120869,  0.27108372,
        0.27095888,  0.27083415,  0.27070954,  0.27058506,  0.2704607 ,
        0.27033645,  0.27021233,  0.27008833,  0.26996445,  0.26984069,
        0.26971705,  0.26959353,  0.26947013,  0.26934685,  0.26922369,
        0.26910065,  0.26897772,  0.26885492,  0.26873224,  0.26860967,
        0.26848722,  0.2683649 ,  0.26824269,  0.26812059,  0.26799862,
        0.26787677,  0.26775503,  0.26763341,  0.26751191,  0.26739052,
        0.26726926,  0.26714811,  0.26702707,  0.26690616,  0.26678536,
        0.26666467,  0.26654411,  0.26642366,  0.26630333,  0.26618311,
        0.26606301,  0.26594302,  0.26582315,  0.2657034 ,  0.26558376,
        0.26546424,  0.26534483,  0.26522553,  0.26510636,  0.26498729,
        0.26486834,  0.26474951,  0.26463079,  0.26451218,  0.26439369,
        0.26427532,  0.26415705,  0.2640389 ,  0.26392086,  0.26380294,
        0.26368513,  0.26356744,  0.26344985,  0.26333238,  0.26321502,
        0.26309778,  0.26298065,  0.26286363,  0.26274672,  0.26262992,
        0.26251324,  0.26239667,  0.26228021,  0.26216386,  0.26204762,
        0.26193149,  0.26181548,  0.26169958,  0.26158378,  0.2614681 ,
        0.26135253,  0.26123707,  0.26112172,  0.26100648,  0.26089135,
        0.26077633,  0.26066143,  0.26054663,  0.26043194,  0.26031736,
        0.26020289,  0.26008853,  0.25997427,  0.25986013,  0.2597461 ,
        0.25963217,  0.25951836,  0.25940465,  0.25929105,  0.25917756,
        0.25906418,  0.2589509 ,  0.25883773,  0.25872468,  0.25861172,
        0.25849888,  0.25838615,  0.25827352,  0.258161  ,  0.25804858,
        0.25793627,  0.25782407,  0.25771198,  0.25759999,  0.25748811,
        0.25737634,  0.25726467,  0.25715311,  0.25704165,  0.2569303 ,
        0.25681906,  0.25670792,  0.25659689,  0.25648596,  0.25637514,
        0.25626442,  0.25615381,  0.2560433 ,  0.2559329 ,  0.25582261,
        0.25571241,  0.25560232,  0.25549234,  0.25538246,  0.25527269,
        0.25516301,  0.25505345,  0.25494398,  0.25483462,  0.25472537,
        0.25461621,  0.25450716,  0.25439822,  0.25428937,  0.25418063,
        0.25407199,  0.25396346,  0.25385503,  0.2537467 ,  0.25363847,
        0.25353034,  0.25342232,  0.2533144 ,  0.25320658,  0.25309886,
        0.25299125,  0.25288373,  0.25277632,  0.25266901,  0.2525618 ,
        0.25245469,  0.25234768,  0.25224077,  0.25213397,  0.25202726,
        0.25192066,  0.25181415,  0.25170775,  0.25160145,  0.25149524,
        0.25138914,  0.25128313,  0.25117723,  0.25107142,  0.25096572,
        0.25086011,  0.25075461,  0.2506492 ,  0.25054389,  0.25043868,
        0.25033357,  0.25022856,  0.25012365,  0.25001884,  0.24991412,
        0.2498095 ,  0.24970498,  0.24960056,  0.24949624,  0.24939202,
        0.24928789,  0.24918386,  0.24907993,  0.24897609,  0.24887236,
        0.24876872,  0.24866517,  0.24856173,  0.24845838,  0.24835513,
        0.24825197,  0.24814891,  0.24804595,  0.24794309,  0.24784032,
        0.24773765,  0.24763507,  0.24753259,  0.2474302 ,  0.24732791,
        0.24722572,  0.24712362,  0.24702162,  0.24691971,  0.2468179 ,
        0.24671618,  0.24661456,  0.24651303,  0.2464116 ,  0.24631027,
        0.24620902,  0.24610787,  0.24600682,  0.24590586,  0.245805  ,
        0.24570423,  0.24560355,  0.24550297,  0.24540248,  0.24530208,
        0.24520178,  0.24510157,  0.24500145,  0.24490143,  0.2448015 ,
        0.24470167,  0.24460193,  0.24450228,  0.24440272,  0.24430325,
        0.24420388,  0.2441046 ,  0.24400542,  0.24390632,  0.24380732,
        0.24370841,  0.24360959,  0.24351086,  0.24341223,  0.24331369,
        0.24321524,  0.24311688,  0.24301861,  0.24292043,  0.24282234,
        0.24272435,  0.24262644,  0.24252863,  0.24243091,  0.24233328,
        0.24223574,  0.24213829,  0.24204093,  0.24194366,  0.24184648,
        0.24174939,  0.24165239,  0.24155548,  0.24145866,  0.24136193,
        0.24126529,  0.24116874,  0.24107227,  0.2409759 ,  0.24087962,
        0.24078287,  0.2405867 ,  0.23998874,  0.23867597,  0.23637838,
        0.23290821,  0.22835804,  0.22322339,  0.21796397,  0.21292083,
        0.20831786,  0.20423962,  0.20063489,  0.19744637,  0.19462525,
        0.1921299 ,  0.18992484,  0.18797983,  0.18626916,  0.18477104,
        0.18346715,  0.18234223,  0.18138377,  0.18058178,  0.17992861,
        0.17941888]) * 1e-1
gamma = np.array(data['SysGammaBspline.Gamma'][-1]) * 1e-1 * 180/np.pi

file_name = os.path.join(folder_path, '737')
file_array = [dist, altitude, speed, alpha, throttle, eta, fuel,
              rho, lift_c, drag_c, thrust, gamma, weight,
              temp]

np.save(file_name, file_array)

# file_name = os.path.join(folder_path, '737.npy')
# (dist, altitude, speed, alpha, throttle, eta, fuel,
# rho, lift_c, drag_c, thrust, gamma, weight,
# temp) = np.load(file_name)


dist = dist/(1e3 * 1.852)
mach = speed / np.sqrt(1.4*288.0*temp)
altitude *= 3.28
speed *= 1.94
fuel *= 0.225
thrust *= 0.225
weight *= 0.225


plt.rc('text', usetex=True)
plt.rc('font', family='serif')

#fig = plt.figure(figsize=(8.0,8.0))
subfig, subax = plt.subplots(8, 1, sharex=True)


values = [altitude/1e3, # speeds[index], 
          gamma, mach, alpha,
          lift_c, lift_c/drag_c,
          thrust/1e5, fuel/1e2, throttle]
labels = [' Alt ($10^3$ ft)', # 'TAS (knots)',
          'Path Angle (deg)', 'Mach', 'AoA (deg)',
          '$C_L$', '$L/D$',
          'Thrust ($10^3$ lb)', 'Fuel ($10^3$ lb)', 'Throttle']
limits = [[-5, 45], # [386, 586],
          [-4, 14], [.4, 0.82], [-.75, 3.0],
          [0.24, 0.6], [15, 22],
          [-1, 35], [-2, 40], [-0.1, 1.1]]
ticks = [[0, 40], [-3, 11], [.5, .78], [-.5, 2.8],
         [0.26, 0.58], [16, 20], [0, 33], [0, 38], [0, 1]]


for i, a in enumerate(subax):

    a.plot(dist, values[i], color='b', linewidth=1)
    a.spines['top'].set_visible(False)
    a.spines['right'].set_visible(False)
    if i < 7:
        a.spines['bottom'].set_visible(False)
        a.get_yaxis().tick_left()
        #a.set_xticks([])
        a.get_xaxis().set_visible(False)
    else:
        a.get_yaxis().tick_left()
        a.set_xticks([0.0, 2950])
    a.set_ylabel(r'%s' % (labels[i]), rotation='horizontal', fontsize=10, ha='right')
    a.set_xlim(-50, 3050)
    a.set_yticks(ticks[i])
    a.set_ylim(limits[i])
    for tick in a.yaxis.get_major_ticks():
        tick.label.set_fontsize(10)
    subfig.subplots_adjust(left=0.2, right=0.98, top=0.98, bottom=0.08,
                           wspace=0.05, hspace=0.1)

a.set_xlabel(r'Range', fontsize=10)
# subfig.savefig('./plots/SciTech_CarpetRange.png')
subfig.savefig('./plots/SciTech_737.pdf')
